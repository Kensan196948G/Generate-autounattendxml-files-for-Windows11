# Windows 11 Sysprep WebUI 使い方ガイド

## 📚 目次

1. [はじめに](#はじめに)
2. [システムの起動](#システムの起動)
3. [基本的な使い方](#基本的な使い方)
4. [詳細設定](#詳細設定)
5. [ファイルのダウンロード](#ファイルのダウンロード)
6. [よくある使用例](#よくある使用例)

## はじめに

このガイドでは、Windows 11 Sysprep WebUIシステムの使い方を詳しく説明します。

## システムの起動

### 方法1: 自動起動スクリプト（推奨）

```powershell
# WebUIフォルダに移動
cd E:\Generate-autounattendxml-files-for-Windows11\WebUI

# 自動起動スクリプトを実行
.\Auto-Fix-All-Simple.ps1 -Verbose
```

スクリプトが自動的に：
- 必要な依存関係をインストール
- ポート競合を解決
- バックエンドとフロントエンドを起動
- ブラウザでUIを開く

### 方法2: 手動起動

```powershell
# バックエンドを起動
.\Start-Backend-8081.ps1

# 別のターミナルでフロントエンドを起動
.\Start-Frontend.ps1
```

### アクセス方法

起動後、以下のURLにアクセス：
- **メインUI**: http://[あなたのIP]:3050/
- **API仕様書**: http://[あなたのIP]:8081/api/docs

## 基本的な使い方

### ステップ1: 基本設定

1. **Windowsエディション選択**
   - プルダウンから選択（デフォルト: Windows 11 Pro）
   - 対応エディション：
     - Windows 11 Pro
     - Windows 11 Home
     - Windows 11 Enterprise
     - Windows 11 Education

2. **言語設定**
   - デフォルトで日本語（ja-JP）が設定済み
   - 変更不要な場合はそのまま

3. **プロダクトキー**
   - 汎用キーが自動設定される
   - 本番キーがある場合は入力

### ステップ2: ユーザーアカウント設定

1. **「ローカルアカウントを作成」を選択**

2. **アカウント情報を入力**
   ```
   ユーザー名: admin-user
   パスワード: P@ssw0rd123!
   表示名: 管理者
   グループ: Administrators
   ```

3. **複数アカウントの追加**
   - 「+ アカウントを追加」ボタンをクリック
   - 最大5アカウントまで設定可能

### ステップ3: ネットワーク設定

#### Wi-Fi設定（オプション）

1. **「次の設定を使用してWi-Fiを構成します」を選択**

2. **Wi-Fi情報を入力**
   ```
   SSID: YourWiFiName
   パスワード: YourWiFiPassword
   自動接続: ✓（チェック）
   ```

#### オフラインインストール設定

- **「Microsoftアカウントをバイパス」**: ✓
- **「ネットワーク接続をバイパス」**: ✓

### ステップ4: Windows機能の設定

必要な機能にチェック：
- □ .NET Framework 3.5
- □ Hyper-V
- □ Windows Subsystem for Linux (WSL)
- □ Windows Sandbox

### ステップ5: システム要件設定

Windows 11の要件を満たさないPCの場合：
- **「Windows 11要件をバイパス」**: ✓
  - TPM 2.0チェックをスキップ
  - セキュアブートチェックをスキップ
  - CPU要件チェックをスキップ

## 詳細設定

### プライバシー設定

1. **「プライバシー設定をスキップ」**: ✓
   - 診断データ送信を最小限に
   - 広告IDを無効化

### デスクトップアイコン

表示したいアイコンを選択：
- □ このPC
- □ ネットワーク
- □ ごみ箱
- □ ユーザーフォルダー

### 初回ログオン時の設定

PowerShellコマンドを追加可能：
```powershell
# 例：Windows Updateを無効化
Set-Service -Name wuauserv -StartupType Disabled
```

## ファイルのダウンロード

### オプション1: XMLのみ

1. **「📥 XMLのみダウンロード」ボタンをクリック**
2. `autounattend.xml`がダウンロードされる
3. USBメディアのルートに配置

### オプション2: XML + 設定ログ

1. **「📦 XML + 設定ログをダウンロード」ボタンをクリック**
2. `unattend_package.zip`がダウンロードされる
3. 内容：
   - `autounattend.xml` - 無人応答ファイル
   - `設定ログ.txt` - 日本語での設定内容記録

## よくある使用例

### 例1: 開発環境用PC

```yaml
エディション: Windows 11 Pro
ユーザー: dev-user (Administrators)
Windows機能:
  - Hyper-V: 有効
  - WSL: 有効
  - .NET Framework 3.5: 有効
要件バイパス: 有効
```

### 例2: 企業向けPC

```yaml
エディション: Windows 11 Enterprise
ユーザー: 
  - local-admin (Administrators)
  - standard-user (Users)
Windows機能:
  - .NET Framework 3.5: 有効
プライバシー: すべてスキップ
Wi-Fi: 企業ネットワーク設定
```

### 例3: テスト環境

```yaml
エディション: Windows 11 Pro
ユーザー: test-admin
要件バイパス: すべて有効
オフラインインストール: 有効
最小構成
```

## トラブルシューティング

### Q: ブラウザでアクセスできない

A: 以下を確認：
1. サービスが起動しているか確認
   ```powershell
   .\Test-Connection.ps1
   ```
2. ファイアウォールを一時的に無効化
3. 正しいIPアドレスを使用しているか確認

### Q: ダウンロードが失敗する

A: 以下を試す：
1. ブラウザのキャッシュをクリア
2. 別のブラウザで試す
3. バックエンドを再起動
   ```powershell
   .\Restart-Backend.ps1
   ```

### Q: 設定が反映されない

A: 以下を確認：
1. 必須項目がすべて入力されているか
2. パスワードが要件を満たしているか（8文字以上）
3. コンソールでエラーが出ていないか確認

## 設定ファイルの使用方法

生成した`autounattend.xml`の使用：

1. **USBインストールメディアの準備**
   - Windows 11インストールメディアを作成
   - USBメディアのルートディレクトリに`autounattend.xml`をコピー

2. **インストール実行**
   - USBメディアからPCを起動
   - 自動的に設定が適用される
   - 無人でインストールが完了

3. **確認事項**
   - 設定したユーザーでログイン可能か
   - Windows機能が有効化されているか
   - ネットワーク設定が適用されているか

## サポート

問題が解決しない場合：
1. `logs`フォルダのログファイルを確認
2. GitHubのIssueセクションで報告
3. 設定ログを添付して詳細を説明

---

*最終更新: 2025年8月24日*