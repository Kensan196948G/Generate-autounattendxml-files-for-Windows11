# Windows 11 Sysprep 設定項目リファレンス

## 📋 設定項目一覧

このドキュメントでは、Windows 11 Sysprep WebUIで設定可能なすべての項目について詳しく説明します。

## 1. 基本設定

### 1.1 Windowsエディション

| 項目 | 値 | 説明 | プロダクトキー |
|------|-----|------|---------------|
| Windows 11 Pro | Pro | プロフェッショナル版 | VK7JG-NPHTM-C97JM-9MPGT-3V66T |
| Windows 11 Home | Home | ホーム版 | YTMG3-N6DKC-DKB77-7M9GH-8HVX7 |
| Windows 11 Enterprise | Enterprise | エンタープライズ版 | NPPR9-FWDCX-D2C8J-H872K-2YT43 |
| Windows 11 Education | Education | 教育機関向け | NW6C2-QMPVW-D7KKK-3GKT6-VCFB2 |

### 1.2 言語・地域設定

| 設定項目 | デフォルト値 | 設定可能な値 | 説明 |
|----------|-------------|--------------|------|
| 言語 | ja-JP | ja-JP, en-US, zh-CN など | システム言語 |
| タイムゾーン | Tokyo Standard Time | 各種タイムゾーン | 時刻設定 |
| キーボードレイアウト | 0411:00000411 | 各種レイアウト | 日本語IME |
| システムロケール | ja-JP | 各種ロケール | 地域設定 |

### 1.3 アーキテクチャ

| 値 | 説明 | 対応CPU |
|----|------|---------|
| amd64 | 64ビット版 | Intel/AMD 64bit |
| x86 | 32ビット版 | Intel/AMD 32bit（非推奨） |
| arm64 | ARM版 | ARM プロセッサ |

## 2. ユーザーアカウント設定

### 2.1 ローカルアカウント

| 項目 | 必須 | 制約 | 説明 |
|------|------|------|------|
| ユーザー名 | ○ | 20文字以内、英数字 | ログイン名 |
| パスワード | ○ | 8文字以上 | ログインパスワード |
| 表示名 | × | 制限なし | 画面表示名 |
| 説明 | × | 256文字以内 | アカウント説明 |
| グループ | × | Administrators/Users | 所属グループ |

### 2.2 パスワード要件

- 最小長: 8文字
- 推奨: 大文字・小文字・数字・記号を含む
- エンコード: Base64 (UTF-16LE + "Password")

### 2.3 グループ権限

| グループ | 権限レベル | 用途 |
|----------|-----------|------|
| Administrators | 管理者 | システム全体の管理 |
| Users | 標準ユーザー | 一般的な使用 |
| Guests | ゲスト | 制限付きアクセス |

## 3. ネットワーク設定

### 3.1 Wi-Fi設定

| 項目 | 必須 | デフォルト | 説明 |
|------|------|-----------|------|
| SSID | ○ | - | ネットワーク名 |
| パスワード | ○ | - | ネットワークパスワード |
| 認証方式 | × | WPA2PSK | WPA2PSK/WPA3SAE |
| 暗号化 | × | AES | AES/TKIP |
| 自動接続 | × | true | 起動時自動接続 |

### 3.2 バイパス設定

| 設定 | 効果 | 推奨環境 |
|------|------|----------|
| Microsoftアカウントバイパス | ローカルアカウントでセットアップ | 企業環境 |
| ネットワーク接続バイパス | オフラインインストール可能 | 隔離環境 |
| ネットワークチェックスキップ | インターネット要件を無視 | テスト環境 |

## 4. Windows機能

### 4.1 オプション機能

| 機能名 | 説明 | 用途 | サイズ |
|--------|------|------|--------|
| .NET Framework 3.5 | レガシー.NETランタイム | 古いアプリ対応 | 約500MB |
| Hyper-V | 仮想化プラットフォーム | VM環境構築 | 約1GB |
| WSL | Linux サブシステム | Linux環境 | 約1GB |
| Windows Sandbox | 隔離環境 | テスト実行 | 約500MB |
| IIS | Webサーバー | Web開発 | 約1GB |

### 4.2 機能の有効化タイミング

| タイミング | 説明 | メリット | デメリット |
|-----------|------|---------|-----------|
| インストール時 | OSインストール中に有効化 | 時間短縮 | イメージサイズ増加 |
| 初回起動時 | 初回ログオン時に有効化 | 柔軟性 | 初回起動が遅い |
| 手動 | ユーザーが後で有効化 | 最小構成 | 手間がかかる |

## 5. システム要件バイパス

### 5.1 Windows 11要件

| 要件 | 最小値 | バイパス可能 | 影響 |
|------|--------|--------------|------|
| TPM | 2.0 | ○ | セキュリティ低下 |
| セキュアブート | 有効 | ○ | セキュリティ低下 |
| CPU | 第8世代以降 | ○ | パフォーマンス |
| RAM | 4GB | ○ | 動作不安定 |
| ストレージ | 64GB | × | インストール不可 |
| UEFI | 必須 | × | インストール不可 |

### 5.2 バイパス方法

```xml
<!-- レジストリ設定でバイパス -->
<RunSynchronous>
  <RunSynchronousCommand>
    <Path>reg add HKLM\SYSTEM\Setup\LabConfig /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
    <Order>1</Order>
  </RunSynchronousCommand>
</RunSynchronous>
```

## 6. プライバシー設定

### 6.1 診断データ

| レベル | 送信内容 | プライバシー | パフォーマンス |
|--------|----------|--------------|----------------|
| セキュリティ | 最小限 | 高 | 影響なし |
| 基本 | 基本的な診断 | 中 | 影響小 |
| 拡張 | 詳細な診断 | 低 | 影響中 |
| 完全 | すべての診断 | 最低 | 影響大 |

### 6.2 プライバシー項目

| 項目 | スキップ時の動作 | 影響 |
|------|------------------|------|
| 位置情報 | 無効 | 位置情報サービス利用不可 |
| 音声認識 | 無効 | Cortana利用不可 |
| 診断データ | 最小限 | Microsoftへのデータ送信最小化 |
| 広告ID | 無効 | パーソナライズ広告なし |
| 手書き入力 | 無効 | 手書き認識の精度低下 |

## 7. デスクトップ設定

### 7.1 デスクトップアイコン

| アイコン | レジストリキー | デフォルト |
|----------|---------------|------------|
| このPC | {20D04FE0-3AEA-1069-A2D8-08002B30309D} | 非表示 |
| ネットワーク | {F02C1A0D-BE21-4350-88B0-7367FC96EF3C} | 非表示 |
| ごみ箱 | {645FF040-5081-101B-9F08-00AA002F954E} | 表示 |
| ユーザーフォルダー | {59031a47-3f72-44a7-89c5-5595fe6b30ee} | 非表示 |
| コントロールパネル | {5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0} | 非表示 |

### 7.2 タスクバー設定

| 項目 | 設定可能 | デフォルト |
|------|----------|------------|
| 検索ボックス | 表示/非表示/アイコンのみ | 表示 |
| タスクビュー | 表示/非表示 | 表示 |
| ウィジェット | 表示/非表示 | 表示 |
| チャット | 表示/非表示 | 非表示 |

## 8. 初回ログオンコマンド

### 8.1 実行タイミング

| タイミング | 説明 | 用途 |
|-----------|------|------|
| FirstLogonCommands | 初回ログオン時 | 初期設定 |
| LogonCommands | 毎回ログオン時 | 定期実行 |
| RunOnce | 一度だけ実行 | 初期設定 |

### 8.2 コマンド例

```powershell
# Windows Update無効化
Set-Service -Name wuauserv -StartupType Disabled

# 電源設定変更
powercfg -change -monitor-timeout-ac 0

# ファイアウォール無効化
netsh advfirewall set allprofiles state off

# 時刻同期
w32tm /config /manualpeerlist:"time.windows.com" /syncfromflags:manual
```

## 9. OOBE設定

### 9.1 スキップ可能な画面

| 画面 | XMLタグ | 効果 |
|------|---------|------|
| EULA | HideEULAPage | 使用許諾契約をスキップ |
| OEM登録 | HideOEMRegistrationScreen | OEM情報入力をスキップ |
| オンラインアカウント | HideOnlineAccountScreens | MSアカウントをスキップ |
| ワイヤレス設定 | HideWirelessSetupInOOBE | Wi-Fi設定をスキップ |
| プライバシー設定 | ProtectYourPC | プライバシー設定を自動 |

### 9.2 OOBE動作モード

| モード | 値 | 説明 |
|--------|-----|------|
| 完全スキップ | SkipMachineOOBE=true | すべてスキップ |
| ユーザー設定のみ | SkipUserOOBE=false | ユーザー設定は表示 |
| カスタム | 個別設定 | 必要な項目のみ表示 |

## 10. ディスク構成

### 10.1 パーティション構成

| パーティション | サイズ | ファイルシステム | 用途 |
|---------------|--------|-----------------|------|
| システム | 100MB | FAT32 | EFI |
| MSR | 16MB | - | 予約領域 |
| Windows | 残り全部 | NTFS | OS |
| 回復 | 500MB | NTFS | 回復環境 |

### 10.2 ディスクモード

| モード | 説明 | 推奨環境 |
|--------|------|----------|
| 自動 | 自動パーティション | 新規インストール |
| 手動 | カスタムパーティション | 上級者向け |
| 既存維持 | 既存パーティション使用 | アップグレード |

---

*最終更新: 2025年8月24日*