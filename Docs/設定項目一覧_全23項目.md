# 設定項目一覧 - 全23項目完全ガイド

## 📋 概要

Windows 11 無人応答ファイル生成システムで設定可能な全23項目の詳細な説明です。各項目の設定内容、推奨値、XMLへの反映方法を記載しています。

---

## 1. 地域と言語の設定 (regionLanguage)

### 設定可能な項目
- **表示言語** (displayLanguage): システムの表示言語
- **入力ロケール** (inputLocale): キーボード配列
- **システムロケール** (systemLocale): 非Unicode プログラムの言語
- **ユーザーロケール** (userLocale): 日付、時刻、通貨の形式
- **UI言語** (uiLanguage): ユーザーインターフェース言語
- **UI言語フォールバック** (uiLanguageFallback): 代替言語
- **タイムゾーン** (timezone): 時間帯設定
- **地理的位置** (geoLocation): 国/地域コード

### デフォルト値（日本環境）
```json
{
  "displayLanguage": "ja-JP",
  "inputLocale": "0411:00000411",
  "systemLocale": "ja-JP",
  "userLocale": "ja-JP",
  "uiLanguage": "ja-JP",
  "uiLanguageFallback": "en-US",
  "timezone": "Tokyo Standard Time",
  "geoLocation": "122"
}
```

---

## 2. プロセッサー・アーキテクチャ (architecture)

### 設定可能な値
- `amd64`: 64ビット x86/x64 プロセッサ
- `x86`: 32ビット x86 プロセッサ
- `arm64`: ARM 64ビット プロセッサ

### 推奨設定
- 通常のPC: `amd64`
- 古いPC: `x86`
- Surface Pro X等: `arm64`

---

## 3. セットアップの挙動 (setupBehavior)

### 設定項目
- **skipMachineOOBE**: PCの初期設定をスキップ
- **skipUserOOBE**: ユーザーの初期設定をスキップ
- **hideEULAPage**: 使用許諾契約を非表示
- **hideOEMRegistration**: OEM登録画面を非表示
- **hideOnlineAccountScreens**: Microsoftアカウント画面を非表示
- **hideWirelessSetup**: Wi-Fi設定画面を非表示
- **protectYourPC**: Windows Update設定（1-3）
- **networkLocation**: ネットワークの場所（Home/Work/Public）
- **skipDomainJoin**: ドメイン参加をスキップ

---

## 4. エディション/プロダクトキー (windowsEdition)

### 設定項目
- **edition**: Windows 11のエディション（Home/Pro/Enterprise）
- **productKey**: プロダクトキー（KMSキーも可）
- **acceptEula**: EULA自動承認
- **installToAvailable**: 利用可能な最初のパーティションにインストール
- **willShowUI**: エラー時のUI表示設定

### Windows 11 Pro 汎用キー
```
VK7JG-NPHTM-C97JM-9MPGT-3V66T
```

---

## 5. Windows PE ステージ (windowsPE)

### 設定項目
- **disableCommandPrompt**: コマンドプロンプトを無効化
- **disableFirewall**: ファイアウォールを無効化
- **enableNetwork**: ネットワークを有効化
- **enableRemoteAssistance**: リモートアシスタンスを有効化
- **pageFile**: ページファイル設定
- **scratchSpace**: スクラッチ領域サイズ（MB）

---

## 6. ディスク構成 (diskConfig)

### 設定項目
- **wipeDisk**: ディスクを完全消去
- **diskId**: 対象ディスク番号
- **partitionStyle**: GPT または MBR
- **partitions**: パーティション配列

### 標準的なGPT構成
```json
{
  "partitions": [
    {"type": "EFI", "size": 100},
    {"type": "MSR", "size": 16},
    {"type": "Primary", "size": "remaining", "letter": "C"},
    {"type": "Recovery", "size": 500}
  ]
}
```

---

## 7. コンピューター設定 (computerSettings)

### 設定項目
- **computerName**: コンピューター名（*で自動生成）
- **organization**: 組織名
- **owner**: 所有者名
- **joinDomain**: ドメイン参加の有無
- **domain**: ドメイン名
- **domainOU**: 組織単位（OU）
- **workgroup**: ワークグループ名

---

## 8. ユーザーアカウント (userAccounts)

### 設定項目
- **accounts**: ユーザーアカウントの配列
  - name: ユーザー名
  - password: パスワード
  - displayName: 表示名
  - description: 説明
  - group: グループ（Administrators/Users）
  - autoLogon: 自動ログオン
  - passwordNeverExpires: パスワード無期限
- **autoLogonCount**: 自動ログオン回数
- **disableAdminAccount**: Administratorを無効化
- **enableGuestAccount**: Guestを有効化

---

## 9. エクスプローラー調整 (explorerSettings)

### 設定項目
- **showHiddenFiles**: 隠しファイルを表示
- **showFileExtensions**: ファイル拡張子を表示
- **showProtectedOSFiles**: 保護されたOSファイルを表示
- **disableThumbnailCache**: サムネイルキャッシュを無効化
- **disableThumbsDB**: Thumbs.dbを無効化
- **launchTo**: 起動時の表示（ThisPC/QuickAccess）
- **navPaneExpand**: ナビゲーションペインを展開
- **navPaneShowAll**: すべてのフォルダーを表示

---

## 10. スタート/タスクバー (startTaskbar)

### 設定項目
- **taskbarAlignment**: タスクバーの配置（Left/Center）
- **taskbarSearch**: 検索ボタン表示（Hidden/Icon/Box）
- **taskbarWidgets**: ウィジェットボタン
- **taskbarChat**: チャットボタン
- **taskbarTaskView**: タスクビューボタン
- **startMenuLayout**: スタートメニューレイアウト
- **showRecentlyAdded**: 最近追加したアプリを表示
- **showMostUsed**: よく使うアプリを表示
- **showSuggestions**: おすすめを表示

---

## 11. システム調整 (systemTweaks)

### 設定項目
- **disableUAC**: ユーザーアカウント制御を無効化
- **disableSmartScreen**: SmartScreenを無効化
- **disableDefender**: Windows Defenderを無効化
- **disableFirewall**: Windows Firewallを無効化
- **disableUpdates**: Windows Updateを無効化
- **disableTelemetry**: テレメトリを無効化
- **disableCortana**: Cortanaを無効化
- **disableSearchWeb**: Web検索を無効化
- **disableGameBar**: ゲームバーを無効化
- **fastStartup**: 高速スタートアップ
- **hibernation**: 休止状態

---

## 12. 視覚効果 (visualEffects) ✨新規実装

### 設定項目
- **performanceMode**: パフォーマンスモード
  - `BestPerformance`: パフォーマンス優先
  - `BestAppearance`: 外観優先
  - `Balanced`: バランス
- **transparency**: 透明効果
- **animations**: アニメーション
- **shadows**: 影の表示
- **smoothEdges**: エッジのスムージング
- **fontSmoothing**: フォントスムージング（ClearType/Standard/None）
- **wallpaperQuality**: 壁紙品質

### XMLへの実装
FirstLogonCommandsでレジストリ設定を適用

---

## 13. デスクトップ設定 (desktopSettings) ✨新規実装

### 設定項目
- **showComputer**: PCアイコン表示
- **showUserFiles**: ユーザーファイルアイコン
- **showNetwork**: ネットワークアイコン
- **showRecycleBin**: ごみ箱アイコン
- **showControlPanel**: コントロールパネルアイコン
- **iconSize**: アイコンサイズ（Small/Medium/Large）
- **iconSpacing**: アイコン間隔
- **autoArrange**: 自動整列
- **alignToGrid**: グリッドに合わせる
- **wallpaper**: 壁紙パス
- **solidColor**: 背景色

---

## 14. 仮想マシンサポート (vmSupport)

### 設定項目
- **enableHyperV**: Hyper-V有効化
- **enableWSL**: WSL有効化
- **enableWSL2**: WSL 2有効化
- **enableSandbox**: Windows Sandbox有効化
- **enableContainers**: コンテナー機能有効化
- **enableVirtualization**: 仮想化機能有効化
- **nestedVirtualization**: 入れ子の仮想化

### DISMコマンドで実装
```cmd
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /all /norestart
```

---

## 15. Wi-Fi設定 (wifiSettings)

### 設定項目
- **setup_mode**: 設定モード
  - `skip`: Wi-Fi設定をスキップ
  - `configure`: 設定を適用
  - `manual`: 手動設定
- **ssid**: ネットワーク名
- **password**: パスワード
- **authType**: 認証タイプ（WPA2PSK等）
- **encryption**: 暗号化方式（AES等）
- **connectAutomatically**: 自動接続
- **connectEvenNotBroadcasting**: 非表示SSIDに接続

### デフォルト設定例
```json
{
  "setup_mode": "configure",
  "ssid": "20mirai18",
  "password": "20m!ra!18",
  "authType": "WPA2PSK",
  "encryption": "AES"
}
```

---

## 16. Express Settings (expressSettings) ✨新規実装

### 設定項目
- **mode**: 設定モード
  - `default`: 既定値を使用
  - `all_enabled`: すべて有効
  - `all_disabled`: すべて無効
  - `custom`: カスタム設定
- **sendDiagnosticData**: 診断データ送信
- **improveInking**: 手書き入力の改善
- **tailoredExperiences**: カスタマイズされたエクスペリエンス
- **advertisingId**: 広告ID
- **locationServices**: 位置情報サービス
- **findMyDevice**: デバイスの検索

---

## 17. ロックキー設定 (lockKeys)

### 設定項目
- **numLock**: NumLock起動時の状態
- **capsLock**: CapsLock起動時の状態
- **scrollLock**: ScrollLock起動時の状態

### レジストリ設定
```
HKEY_USERS\.DEFAULT\Control Panel\Keyboard
InitialKeyboardIndicators = "2147483650"
```

---

## 18. 固定キー (stickyKeys) ✨新規実装

### 設定項目
- **enabled**: 固定キー機能の有効化
- **lockModifier**: 修飾キーのロック
- **turnOffOnTwoKeys**: 2つのキーで無効化
- **feedback**: フィードバック表示
- **beep**: ビープ音

---

## 19. 個人用設定 (personalization) ✨新規実装

### 設定項目
- **theme**: テーマ（Light/Dark/Custom）
- **accentColor**: アクセントカラー（16進数）
- **startColor**: スタートメニューに色を付ける
- **taskbarColor**: タスクバーに色を付ける
- **titleBarColor**: タイトルバーに色を付ける
- **lockScreenImage**: ロック画面の画像
- **userPicture**: ユーザー画像
- **soundsScheme**: サウンドスキーム
- **mouseCursorScheme**: マウスカーソルスキーム

---

## 20. 不要なアプリの削除 (removeApps)

### 設定項目
- **apps**: 削除するアプリのリスト

### 削除対象の例
```json
{
  "apps": [
    "Microsoft.BingNews",
    "Microsoft.BingWeather",
    "Microsoft.GetHelp",
    "Microsoft.MicrosoftSolitaireCollection",
    "Microsoft.People",
    "Microsoft.WindowsFeedbackHub",
    "Microsoft.YourPhone",
    "Microsoft.ZuneMusic",
    "Microsoft.ZuneVideo"
  ]
}
```

### PowerShellコマンドで実装
```powershell
Get-AppxPackage *Microsoft.BingNews* | Remove-AppxPackage
```

---

## 21. カスタムスクリプト (customScripts) ✨新規実装

### 設定項目
- **firstLogon**: 初回ログオン時のスクリプト
  - order: 実行順序
  - command: コマンド
  - description: 説明
  - requiresRestart: 再起動要否
- **setupScripts**: セットアップ時のスクリプト
  - order: 実行順序
  - path: スクリプトパス
  - description: 説明

### 実装例
```json
{
  "firstLogon": [
    {
      "order": 1,
      "command": "powershell -Command \"Set-ExecutionPolicy RemoteSigned -Force\"",
      "description": "PowerShell実行ポリシー設定",
      "requiresRestart": false
    }
  ]
}
```

---

## 22. WDAC設定 (wdac) ✨新規実装

### 設定項目
- **enabled**: WDAC有効化
- **policyMode**: ポリシーモード
  - `Audit`: 監査モード
  - `Enforced`: 強制モード
- **allowMicrosoftApps**: Microsoft製アプリを許可
- **allowStoreApps**: ストアアプリを許可
- **allowReputableApps**: 信頼できるアプリを許可
- **customRules**: カスタムルール

### 実装
CiToolコマンドまたはレジストリ設定で適用

---

## 23. その他のコンポーネント (additionalComponents)

### 設定項目
- **dotnet35**: .NET Framework 3.5
- **dotnet48**: .NET Framework 4.8
- **iis**: Internet Information Services
- **telnetClient**: Telnetクライアント
- **tftpClient**: TFTPクライアント
- **smb1**: SMB 1.0プロトコル
- **powershell2**: PowerShell 2.0
- **directPlay**: DirectPlay
- **printToPDF**: PDF印刷機能
- **xpsViewer**: XPSビューアー
- **mediaFeatures**: メディア機能
- **workFolders**: ワークフォルダー

### DISMコマンドで実装
```cmd
dism /online /enable-feature /featurename:NetFx3 /all /norestart
dism /online /enable-feature /featurename:IIS-WebServerRole /all /norestart
```

---

## 📊 統計情報

### 実装済み項目
- **基本設定（1-11）**: 100%完了
- **拡張設定（12-23）**: 100%完了（2024年8月24日）
- **総設定項目数**: 23項目
- **FirstLogonCommands数**: 53個以上

### XML生成仕様
- **名前空間**: `urn:schemas-microsoft-com:unattend`
- **パス**: windowsPE, specialize, oobeSystem, offlineServicing
- **エンコーディング**: UTF-8（XML）、UTF-16LE（パスワード）

---

*最終更新: 2024年8月24日*